
.ONESHELL:

asFile01 := readgpioid
asFile02 := allinstructions
asFile03 := filldmem
asFile04 := instr01loadbyte    # 4th test
asFile05 := instr02loadhalf    # 5th test
asFile06 := instr03loadword    # 6th test
asFile07 := instr19add
asFile08 := instr04loadbyteu   # 7th test
asFile09 := instr05loadhalfu   # 8th test
asFile10 := instr06addi        # third test
asFile11 := instr07slli        # second test
asFile29 := instr29lui         # first test
asFile99 := instr99loadimem    # load the I-Mem via JTAG

asmFiles := $(asFile99) \
	$(asFile01) \
	$(asFile04) \
	$(asFile05) \
	$(asFile06) \
	$(asFile08) \
	$(asFile09) \
	$(asFile07) \
	$(asFile11) \
	$(asFile29)


#asmFiles := $(asFile99)
#asmFiles := $(asFile01)

.phony : doit
doit:
	$(foreach var,$(asmFiles), \
	echo $(var); \
	cp rv64Sim/$(var).asm rv64Sim/rv64i.asm; \
	cd rv64Sim && $(MAKE) all; \
	cd ..; \
	cp tb/tb_rv64i_$(var).sv tb/tb_rv64i.sv; \
	$(MAKE) -C sim; \
)


.phony : clean
clean:
	@echo "Make clean"
	rm -f *.o
	rm -f *.s
	rm -f *.lst
	cd rv64Sim && $(MAKE) clean
	$(MAKE) clean -C ../sim
